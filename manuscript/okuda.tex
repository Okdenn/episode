\documentclass[11pt]{jsarticle}
\input{okuda-subfolder/preemble}
% \input{okuda-subfolder/colorsforprint}

\begin{comment}
  \begin{figure}[H]
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $X_{11}$ & $1$ & $X_{13}$ \\ \hline
      $X_{21}$ & $X_{22}$ & $X_{23}$ \\ \hline
      $X_{31}$ & $X_{32}$ & $X_{33}$ \\ \hline
    \end{tabular}
    \caption{1のみ入れた状態}
    \label{only1}
  \end{figure}  
\end{comment}

\title{対称性}
\author{奥田 堯子}
\begin{document}
\maketitle
\section{$3\times 3$魔方陣を解こう!}
唐突ですが，$3\times 3$魔方陣，解きたくないですか? え? 解いたことある? そうおっしゃらず，ちょっとお付き合いください．

魔方陣のルールは，ある$n\times n$のマス目に$1$から$n^2$までの数を1回ずつ入れ，すべての縦横斜めの和を等しくするというものです．今回は$n=3$の場合を考えます．$3\times 3$のマスに$1$から$9$の数を1回ずつ入れて縦横斜め全ての和を等しくするということですね．以下単に魔方陣と言った時は$3\times 3$魔方陣とします．また横の並びを行，縦の並びを列 (漢字を見て列が縦方向であることだけ覚えてください) ，斜めを対角線とも言うことにします．

\begin{figure}[H]
  \centering
  \begin{tabular}{|c|c|c|c}
    \cline{1-3}
    $X_{11}$ & $X_{12}$ & $X_{13}$ & $\leftarrow$ 行 \\
    \cline{1-3} 
    $X_{21}$ & $X_{22}$ & $X_{23}$ \\ \cline{1-3}
    $X_{31}$ & $X_{32}$ & $X_{33}$ \\ \cline{1-3}
    \multicolumn{1}{c}{$\uparrow$ 列}& \multicolumn{1}{c}{} & \multicolumn{1}{c}{}& \multicolumn{1}{c}{$\nwarrow$ 対角線}\\
  \end{tabular}
  \caption{行・列・対角線}
  \label{magic}
\end{figure}

大きく2つのアプローチを用意しています．手計算と計算機 (コンピュータ) です．

\section{真面目に手計算}
こういうのをちゃんと解くのも数学です．パズルが好きなあなたにおすすめの section です．

この section を選ばれた方は，次の section も結果は見てください．

\subsection{縦横斜めの和を決定する}
魔方陣のルール上，縦横斜めどの列どの行どの対角線も和が等しくなければいけません．その和はなんでしょうか．

$1\sim 9$の和は$45$です．この魔方陣には$3$列ありますので，各列の和は$15$とならなければいけません．これが今回目指す縦横斜めの和です．

\subsection{真ん中の数を決定する}
和を$15$にしなければならないということがわかったところで，どう数を入れればいいのでしょうか．そこで，最も縦横斜めの和に関係する真ん中の数を決定しましょう．真ん中の数は対角線2本と縦横1本ずつの和に関係します．

例えば真ん中が$1$とするとどうでしょう...... 「アホか」という声が聞こえてきた気がします．なぜアホなのか，それは「小さすぎる」からでしょう．事実，真ん中を$1$としてみると，和を$15$にするためには$14$を足す必要があります．$1\sim 9$を重複なく入れて和を考えるとき，$14$にする組み合わせは$5+9,\ 6+8$の2つしかありません．これでは対角線2本を$15$にするのがやっとです．同様に考えて行くと$4,5,6$のいずれかしか真ん中には入れません．数学書ではこういう単純作業は問題に投げると相場が決まっていますので投げます．

\begin{screen}
  \begin{prob} (真ん中の数の候補) 

    同様に考えることで真ん中の数としてあり得る候補は$4,5,6$であることを確認せよ．
  \end{prob}
\end{screen}

真ん中だし真ん中の数の$5$が入るんだろう，とは思いますが，この考えで決定できるのはここまでです．とりあえず他の場所に移ります．

\subsection{その他の数を決定する}
先ほどの議論より，ある場所に$1$を入れると，$1$が入っている行か列か対角線には$5+9, 6+8$のいずれかを入れることが確定します．ここで4隅を見てみると，この部分は縦横斜め3本に関係します．つまり$5+9, 6+8$の2通りでは足りません．よって$1$は4隅に入れないということがわかります．

ここで$1$の入る場所が決定しました---中央でもなく4隅でもない場所です．とりあえずここにいれて話を進めましょう (次図\ref{only1}参照) ．

\begin{figure}[H]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline
    $X_{11}$ & $1$ & $X_{13}$ \\ \hline
    $X_{21}$ & $X_{22}$ & $X_{23}$ \\ \hline
    $X_{31}$ & $X_{32}$ & $X_{33}$ \\ \hline
  \end{tabular}
  \caption{1のみ入れた状態}
  \label{only1}
\end{figure}

$1$が入る場所が決まってしまうと，その行と列には$5+9, 6+8$が入ることが確定します．特に先ほど真ん中の数の候補として残っている$5$か$6$が真ん中に入ることが確定しました．

次に，$1$と同様に極端な数$9$について考えてみると，これも$15$にする組み合わせは$1+5, 2+4$の2通りしかないことより4隅には入れないことが確定し，1の入った列に$5, 9$が入ることが確定します．やっぱり$5$が真ん中でしたね．

\begin{figure}[H]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline
    $X_{11}$ & $1$ & $X_{13}$ \\ \hline
    $X_{21}$ & $5$ & $X_{23}$ \\ \hline
    $X_{31}$ & $9$ & $X_{33}$ \\ \hline
  \end{tabular}
  \caption{途中経過1}
  \label{}
\end{figure}

ここまで来てしまえば残りはほぼ単純作業です．$1$の入っている行には$6,8$が，$9$の入っている行には$2,4$が入りますが，対角線に注目して$15$となる組み合わせは$8+2, 6+4$になります．よって次の図\ref{totyu} のようになります．

\begin{figure}[H]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline
    $6$ & $1$ & $8$ \\ \hline
    $X_{21}$ & $5$ & $X_{23}$ \\ \hline
    $2$ & $9$ & $4$ \\ \hline
  \end{tabular}
  \caption{途中経過2}
  \label{totyu}
\end{figure}

最後に$3,7$を残りの部分に適当に入れて完成です．\hyperlink{kansei}{次}のようになります．

\begin{figure}[H]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline
    $6$ & $1$ & $8$ \\ \hline
    $7$ & $5$ & $3$ \\ \hline
    $2$ & $9$ & $4$ \\ \hline
  \end{tabular}
  \caption{完成形}
  \label{kansei}
  \hypertarget{kansei}{}
\end{figure}

さて，完全に答えが出たところで，もう1つの手法，コンピュータでのアプローチのほうがどうなっているかを見てみましょう......

\section{圧倒的な力 (コンピュータ) でのアプローチ}
ええい，真ん中の数字がどうのとしゃらくせぇ，答えが出ればいいんじゃ，という短気なあなたにおすすめなのがこの section です．``Prolog'' というプログラミング言語を用いることでこの問題を一瞬で解きます．

コードは次の通りです．

\begin{lstlisting}
  delete(L = [A|L]-A).
  delete([B|L2] = [B|L1] - A) :-
  delete(L2 = L1 - A).
  permutation([],[]).
  permutation([A|L1], L2) :-
  delete(L3 = L2 - A), permutation(L1, L3).
  magic([X11,X12,X13,X21,X22,X23,X31,X32,X33]) :-
  permutation([1,2,3,4,5,6,7,8,9],
  [X11,X12,X13,X21,X22,X23,X31,X32,X33]),
  X1 is X11+X12+X13, X1 = 15,
  X2 is X21+X22+X23, X2 = 15,
  X3 is X31+X32+X33, X3 = 15,
  Y1 is X11+X21+X31, Y1 = 15,
  Y2 is X12+X22+X32, Y2 = 15,
  Y3 is X13+X23+X33, Y3 = 15,
  Z is X11+X22+X33, Z = 15,
  W is X13+X22+X31, W = 15.
\end{lstlisting}
意味としては，図\ref{magic}の通り，各マス目を左上から$X_{11},\ldots ,X_{33}$とし，各マスには1から9までの数字が1回ずつ入って縦横斜めの和が全て等しいという条件を入れています．最初の辺りは数の入れ替えを定義するための諸々です (コードについては section \ref{okuda:ato} も参照)．これを満たす$X_{11},\ldots ,X_{33}$はなぁに? と訊きます．完全に魔方陣の条件しか入れていませんね．こんなんで解けるのか? と思いますが，この Prolog は優秀で，これだけで解いてくれます．

このコードを入れてぽちっとエンターを押すと\footnote{SWI-Prolog をあなたの PC に入れるなどの Prolog 環境を整えて，ちゃんとこのコードを食わせておき，``magic([X11,X12,X13,X21,X22,X23,X31,X32,X33]).''のクエリを投げると，の省略です．この方法は頭はほとんど使いませんが (今回はコードがあるので)，環境構築と言語理解に頭を使います．}解を一瞬で叩き出してくれます．結果自体は長いので記事末に置きました．結果としては8通りですが，このまま見ても見づらいので図にしましょう．次の\hyperlink{ans}{図たち}です (前 section の解は解1です)．

\begin{figure}[htbp]
  \captionsetup{labelformat=empty}
  \begin{minipage}{0.24\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $6$ & $1$ & $8$ \\ \hline
      $7$ & $5$ & $3$ \\ \hline
      $2$ & $9$ & $4$ \\ \hline
    \end{tabular}
    \caption{解1}
    \label{}
  \end{minipage}
  \begin{minipage}{0.24\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $8$ & $1$ & $6$ \\ \hline
      $3$ & $5$ & $7$ \\ \hline
      $4$ & $9$ & $2$ \\ \hline
    \end{tabular}
    \caption{解2}
    \label{}
  \end{minipage}
  \begin{minipage}{0.24\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $6$ & $7$ & $2$ \\ \hline
      $1$ & $5$ & $9$ \\ \hline
      $8$ & $3$ & $4$ \\ \hline
    \end{tabular}
    \caption{解3}
    \label{}
  \end{minipage}
  \begin{minipage}{0.24\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $8$ & $3$ & $4$ \\ \hline
      $1$ & $5$ & $9$ \\ \hline
      $6$ & $7$ & $2$ \\ \hline
    \end{tabular}
    \caption{解4}
    % \label{ans}
  \end{minipage}
\end{figure}
\begin{figure}[htbp]
  \captionsetup{labelformat=empty}
  \begin{minipage}{0.24\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $2$ & $7$ & $6$ \\ \hline
      $9$ & $5$ & $1$ \\ \hline
      $4$ & $3$ & $8$ \\ \hline
    \end{tabular}
    \caption{解5}
    \hypertarget{ans}{}
    \label{}
  \end{minipage}
  \begin{minipage}{0.24\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $4$ & $3$ & $8$ \\ \hline
      $9$ & $5$ & $1$ \\ \hline
      $2$ & $7$ & $6$ \\ \hline
    \end{tabular}
    \caption{解6}
    \label{}
  \end{minipage}
  \begin{minipage}{0.24\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $2$ & $9$ & $4$ \\ \hline
      $7$ & $5$ & $3$ \\ \hline
      $6$ & $1$ & $8$ \\ \hline
    \end{tabular}
    \caption{解7}
    \label{}
  \end{minipage}
  \begin{minipage}{0.24\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $4$ & $9$ & $2$ \\ \hline
      $3$ & $5$ & $7$ \\ \hline
      $8$ & $1$ & $6$ \\ \hline
    \end{tabular}
    \caption{解8}
    \label{}
  \end{minipage}
\end{figure}

さて，この問題を一瞬にして解いてくれた Prolog ですが，これはこの問題をどのようにして解いているのでしょうか．

Prolog は論理型プログラミング言語に分類されており，実際名前が ``Pro'' ``log''---``{\scshape Pro}gramming in {\scshape Log}ic'' なんやで，という主張をしています．なにが logic，論理学なのかというと，実際に質問，今回なら例えば「こういう魔方陣を解いてほしい」，に答える部分で論理学的な推論規則，``SLD resolution'' を使っているためです．SLD resolution がどのようなものか，なぜそれでちゃんと解けるのかなどなどについては私が詳しくはないのと，それを語りだすとおそらく10ページは費やすことになるので，\cite[Chapter 9]{gellier} に投げようと思います．

Prolog は今でこそマイナー言語で， Python や C++ のような誰もが知っている言語とは言えませんが，実は昔，1980年代前後に (現在も Watson など) 人工知能の開発に主に用いられていました．世が世なら，要因が重なっていたらもしかしたら爆発的に発展したのかもしれません，衰退の理由や言語仕様についてあまり把握していないのでもっと「使えなかった」クリティカルな理由があるのかもしれませんが，少なくとも現在も教育にはよく用いられているようです．

Prolog について理情の友人に訊いたところ，「ゆーて Prolog は全探索」という旨のことを言われた記憶があります．もちろん完全な全探索よりはいろいろ頭を使ってある (そこが logic の由縁でしょう) と思いますが，最後には結構な総当たりではあるようです．

こういうことを聞いてから Prolog が魔方陣解いているのを見ても驚かないかもしれませんが，最初に予備知識無しでこれ見ると本当に感動します (タイムラグも全くありません)．この記事の半分はこの驚きを伝えたくて書かれています．みなさんもぜひ Prolog を! (私はほとんど書けませんが) そして今からでも遅くないので言語モデル論に潜りま(以下自粛)．

\subsection{前の section から真面目に読まれた方}
あれ? 答えが8つ? さっきは1つしか見つからなかったような...? と思った方，焦らなくて大丈夫です．次にそのからくりを説明いたします．実はさっきはかなり強引に誘導したのでお気づきの方もいらっしゃるかもしれませんが，気付かないふりをしてください．

\subsection{この section しか読まなかった短気な方}
あなたが``圧倒的な力''で得た答えは8つですが，実はこれは本質的には1つです，と言われたら驚くでしょうか．それとも当然に感じるでしょうか．次にその理由をご説明します．

\section{$3\times 3$魔方陣の答えに潜む``対称性''}
地道に手でやった解答は1つ，それに対して Prolog が叩き出した答えは8つ．普通に考えれば，手でやった方に見落としがあるか，Prolog が間違えているかのどちらかですが，実はそうではありません．手計算のほうは，ある同一視を行った結果1つという答えを得，Prolog はその同一視を行っていないため8つの答えを得ている，ということが起きているのです．詳しく見てみましょう．

次の2つの解を比べてみましょう．
\begin{figure}[H]
  \captionsetup{labelformat=empty}
  \begin{minipage}{0.49\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $8$ & $1$ & $6$ \\ \hline
      $3$ & $5$ & $7$ \\ \hline
      $4$ & $9$ & $2$ \\ \hline
    \end{tabular}
    \caption{解2}
    \label{}
  \end{minipage}
  \begin{minipage}{0.49\hsize}
    \centering
    \begin{tabular}{|c|c|c|}
      \hline
      $6$ & $7$ & $2$ \\ \hline
      $1$ & $5$ & $9$ \\ \hline
      $8$ & $3$ & $4$ \\ \hline
    \end{tabular}
    \caption{解3}
    \label{}
  \end{minipage}
\end{figure}

この2つは，
% 「左上」という概念を魔方陣に入れ，
魔方陣を固定したうえで，数字が入る場所を区別するならば異なる解です．しかし，そういうことを考えず，このような回転などに依らない，ある意味相対的な位置のみを考えるならば同じ解と言うことができます．たとえば解2を反時計回りに$90^\circ$回すと解3になります．

だんだん1つと8つの理由が見えてきたでしょうか．改めて Prolog が出した解を見てみてください．
% 以下に Prolog が挙げた解を図式化したものを再掲します．Prolog には左上から横に向かって11, 12, 13，次の行の左に移って21, 22, 23... というように番号を振って解かせています．

これらの8つの図は，どのような関係にあるのでしょうか．それを考えるために次を考えてみましょう．

枠に入った\textgt{4隅に区別のある}正方形を，枠から取り出して元の枠にはめ込む (図) とき，そこにはどれだけの自由度があるでしょうか．

まず考え付くのが，時計回り/反時計回りの$90^\circ$回転です．反時計回りを3回行えば時計回りを1回したのと同じになりますので，反時計回り$90^\circ$回転を何回するかで回転全てを表すことにしましょう．さらに$90^\circ$回転は4回行うと元に戻りますので，反時計回り$90^\circ$回転を$0\sim 3$回行う回転以外はありません (0回とは，「回転させない」，動かさないことです．また他の角度の回転では枠にはまりません---気になる人は納得するまでいじって確かめてみましょう) ．

動かし方はこれだけでしょうか．今まで私のペースでガンガンとやってきましたので，ここで少し冊子を伏せて，あるいは自分で作って，考えてみてください．
\begin{screen}
  \begin{prob}
    枠に入った4隅に区別のある正方形を，枠から取り出して元の枠にはめ込むとき，$90^\circ$回転以外にできる動かし方はあるか．ない場合にはそれを示せ．ある場合は1つ例を挙げれば十分である (それですべてか否かを証明する必要はない) ．
  \end{prob}
\end{screen}
考えましたか? それでは正解です．
\begin{ans*}
  動かし方は他にある．裏返す操作である．実は回転と裏返しを繰り返すことでですべてのはめ込み方が得られる．
\end{ans*}

実はこの「はめ込み方」，つまり回転と裏返しの組み合わせ，は，数学で言う「群」を成しています．群の中でも特に2面体群と呼ばれるカテゴリに属しており，正方形，つまり正4角形の回転と裏返しの際に出てくる群であることから，この群を$\mathcal{D}_4$と書きます(流儀によっては$\mathcal{D}_8$と書くこともあります，その理由はそろそろお気づきかもしれませんが，のちほど)．

群と言うのは簡単に言うと次の4つの条件を満たす操作の集まりのことです．
\begin{easylist}[enumerate]
  @ 「何も変えない」という操作を含む
  @ やった操作は取り消せる
  @ $1 + (2 + 3) = (1 + 2) + 3 $である，つまり3つ以上の操作があるとき，最初から2つやって休んでから残りの1つをやっても，最後の2つをやっておいてから最初の1つと組み合わせても結果は同じ．
  @ (その操作は，2つ以上組み合わせてもある一定の枠に収まっている，今回なら例えば文字通り木の枠に正方形を収めるという操作である)
\end{easylist}
わかる人にはまどろっこしいので数式でも書いておきましょう．
\begin{defi}(群)
  
  集合$G$に対し$(G,*)$が群であるとは，演算$*\colon G\times G\to G$が
  \begin{easylist}[itemize]
    @ 単位元$\exists ! e\in G\st \forall g\in G,\ e*g = g*e = g$
    @ $\forall g\in G,\ \exists \inv{g}\st g\inv{g} = \inv{g}g = e $
    @ $g_1,g_2,g_3\in G,\ (g_1*g_2)*g_3 = g_1*(g_2*g_3)$
  \end{easylist}
  を満たすことである．
\end{defi}

% 群作用についても定義できると話が早そう?
普段「群」というと「数」，整数や有理数を挙げて終わりとすることが多く，今回のように「操作の集まり」として定義することは多くないと思います．ここで操作として理解しようとしたのは，「群の作用」という概念の導入のためです．群の作用とは，簡単に言えば群を図形 (など) を動かす操作として見る，ということです．

\begin{defi}(群の作用，\cite[p. 33]{katura} を一部改変)

  群$G$と集合$S$に対し，写像$G\times S\to S,\ (a,x)\mapsto ax $が，
  \begin{easylist}[enumerate]
    @ $a,b\in G$に対し，$x\in S$に対し，$a(bx) = (ab)x $
    @ $e\in G$，単位元に対し，$\forall x\in S,\, ex = x$
  \end{easylist}
\end{defi}

式としてはこういうことですが，つまりは，
\begin{easylist}[enumerate]
  @ (操作の集合である) 群$G$が「なにか」の1点に働きかけるが，働きかけの後でもそれは「なにか」の1点になっている (正方形等は条件を満たす点の「集合」ですが，数学では普段見る図形を含め大体のものは集合なので，考えられるものすべてと思ってもらって差し支えないと思います)
  @ その働きかけは，群の元を1つずつ行っても，群の元をかけてから一気に行っても同じである (これは式のほうがわかりやすいと思います，群の3つめの条件と同じような感じです)
  @ 単位元 (何もしないという操作です) は「なにか」を動かさない
\end{easylist}
ということです．

おそらく明言が必要なのは，同じ正方形でも置いている場所が違うものは違う正方形として考えるという部分です．このことを強調するため，さっきまでの議論では「枠にはめる」という条件のもとで考えてきました．これは正方形等を集合として見れば間違いのないことなのですが，例えば図の2つの正方形は作用を考える上では異なる正方形で，したがって$45^\circ$回転というのは正方形への作用とは考えません ($45^\circ $の議論が通ってしまうなら，同じようにして任意の角度の回転が正方形への作用になってしまうことになりますが，それは「対称性を取り出す」という観点からは少しまずいです)．

ここでそろそろ「手で出した1つと Prolog が出した8つ」の議論を終わらせておきましょう．

正方形へは$90^\circ$の回転と裏返しの組み合わせからなる群$\cD_4$が作用していると考えられます．そして，$\cD_4$の位数 (群の要素 (元) の数のことです) は8です．これは容易に確かめることができて，$90^\circ$の回転と裏返しから，「表向きで$90^\circ$回転を0-3回中何回するか」の4通り，「裏返しで$90^\circ$の回転と裏返しを0-3回中何回するか」の4通りを作ることができ，これらは互いに一致しないからです．$\cD_4$の位数が8であることから，$\cD_4$のことを$\cD_8$と書く人も居ます．

\textgt{手で出した1つの答えに$\cD_4$を作用させると，Prolog の出した答えの8つをすべて出すことができます．逆に Prolog の答えを$\cD_4$の作用のもとで同一視すると，手で出した1つの答えになります．}これが今回の1つと8つの理由です．逆に Prolog が8つしか答えを出してきていないことから，Prolog を信用するなら，相対的な位置の変換を除いた答えはただ1つであることがわかります．

今まで見てきたことだと，群それ自体と群の作用の区別がつきづらいかもしれません (それがこの説明の問題点です)．しかしこの2つは別物です．例えば，同じ群が違う対象に作用し得ます．これは群は同じですが群の作用が異なる例です．あるいは，同じ対象に作用していても群自体が違うこともあります．まとめておきましょう;

\begin{eg}(群と群の作用の違い)
  
  同じ群が違う対象に作用する例: 今まで見てきた$\cD_4 $は，正方形にも作用しますが，円や正八角形などにも作用します．

  同じ対象に違う群が作用する例: 円には，$\cD_4$の他にも，任意の角度の回転からなる群 ($\mathbf{T} $と書く人が居ます\cite[p. 3]{katura} 1次元トーラスと言います) が作用します．
\end{eg}

\section{数学における対称性と群作用}
さて，ここまで$3\times 3$魔方陣の解のある種の対称性について考えてきましたが，現代数学においても「対称性」は非常に重視されています．その最も有名な現れが，Galois 理論(ガロア理論/ガロワ理論)です．

% 正直対称性だけで Galois 理論語りたくないっていうのもあるし(そこまで本質的なのかがよくわかっていない)，自由度や不変量を取り出す現代数学に共通するスキームみたいなものを軽く話したほうがいいのかもしれない，ホモロジーとか．

数学に詳しい人の中には「Galois 理論は解の対称性を用いてどうこう」という話を聞いたことがある人もいると思います．事実，ある方程式の解というのはそれぞれ対等で，どれかの解だけが「偉い」ということはありません．例えば$x^2-2=0$の解は$\pm \sqrt{2} $ですが，このどっちかが「偉い」でしょうか．人間としては正の数を習うのが先なので${+\sqrt{2}}$のほうが自然に感じるかもしれませんが，「先に習うから」というのは理由になりません---負の数を先にやる人類が居たら${-\sqrt{2}}$が自然ということになります．つまり，誰もが納得できる理由でこの2つの解を優劣づけることはできません (実数には順序が入るのでそれを用いて優劣づけることはできなくはないですが，それでも小さい方が「偉い」とする順序を入れていけないという根拠はありません) ．

このような解の対等性を「解の対称性」と言って Galois 理論ではどうこうします．具体的には解の集合に作用する群を考えて，それに対応する体の拡大を考えどうこうどうこうするのですが，これを書き始めるとそれだけで1つ書けてしまうので (\& 著者がそんなに詳しくないので \& 和書洋書多数なので)，ここでは他の文献に譲ることにします．ただ心に留めておくべきことは，Galois 理論では群の，解の集合への作用を考えているということです．ある意味，魔方陣の答えに$\cD_4$が作用している今回の状況と似ています．
% 「対等なものがあったらそこには群の作用がある」という事実です． (飛びすぎ)

同様に，ある集合，特に図形に作用する群は，ある点で，その図形の対称性を取り出しているとも言えます．例えば円に作用する群$\mathbf{T}$は無限群 (元の数が無限) ですが，対して正方形に作用する群$\cD_4$は有限群 (元の数は有限) です．円というのは見た目にもわかる通り，非常に対称性が高い図形です．正方形のほうも低くはありませんが，円よりは若干非対称です．その微妙な部分はすでに「枠へのはめ込み方はどのくらいの数あるか」という部分において無限個と有限個という形で現れています．

これだけだと非常に粗い議論になってしまうのですが，実際は図形に作用する群自体がリー群 (群であると同時にある種の図形 (空間) でもある) と呼ばれるいいクラスの群になり，\sout{単純に私が見ていて楽しいということがあります} というのは冗談なのですが，私がこれの良さを端的に明確に説明できないので，今回は「よくわからんけどちゃんとした発展はある」ということだけ言って置いておきたいと思います．

図形自体を動かして対称性を見る群以外にも，穴の数を数えるのにも群が使われています．基本群と呼ばれる群がそれです．

ここで全体に気になることとして，「群だけからどのくらい元の図形の情報がわかるのか?」ということがあります．事実，ポアンカレ/\Poincare 予想 (そろそろ {\Poincare}--Perelman の定理と言うべきでしょうか) は粗く言えば「穴がなくて (端がなくてそこそこちっちゃい) 図形は3次元における球面か」という問題でしたが，これは「穴がない」という情報，これは基本群の情報です，から球面であると結論づけられるか，という問題でした．\footnote{端があるとか結構大きいとかの場合には，中身の詰まったボール，3次元球体とか平面とかいう反例が容易にできてしまうことなどから，こちらの仮定はそうは強くないものです．}これは運良くというべきか，ペレリマン/Perelman により肯定的に解決されました．つまり「穴がない」という基本群の情報は元の図形が球面であると結論付けるに十分な情報である，という話になりましたが，これを解決するのには100年近くかかったことはご存知の方はご存知の通りで，一般的にその群がどの程度元の図形の情報を持っているか，持っていない場合はどうすれば十分になるか，という議論は非常に難しいものになります．逆に言うとそれが幾何と群の絡みの面白い部分になると個人的には思うのですが，これをここに書いた以上の「言葉」で説明することは私にはできませんので (すでにかなり怒られる書き方をしている)，興味のある方は末尾の文献をご覧いただければと思います (あと実は私はバリバリの代数的トポロジーの人間ではないので，ますらぼに居る執印さんとかがこの話題には詳しいと思います)．

\section{あとがきと教材化について}
\label{okuda:ato}
ここまで，$3\times 3$魔方陣を元手に，条件を絞り込んで解く方法とProlog という論理型プログラミング言語を用いて解いてみる方法，その2つを突き合わせて得られた解の対称性について考え，さらにそこから発展して現代数学における群の重要性について考えてみましたが，いかがでしたでしょうか．

$3\times 3$魔方陣を Prolog で解く，ということ自体は私自身のアイデアではありません．2017年度に理学部情報科学科の「言語モデル論 (小林直樹先生)」という講義を受けた際に，論理型プログラミング言語の例として Prolog が紹介され，その動作の例として$3\times 3$魔方陣を解く様子が紹介されていました．\footnote{Prolog のコードについても言語モデル論の講義資料にあったのですが，講義資料自体が再配布禁止，要パスワードであることから，ある程度それを参考にしつつ，\cite[p. 133--4]{iitaka} により若干の書き換えを行いました．どちらが著作権的に問題ないかという部分では議論が残るように思いますが，これについてはもし駒場祭期間内に問題が寄せられましたら PDF 版の方では非公開にすることにしたいと思います．また完全な公開資料ではないという理由で末尾の文献リストにもこの講義資料は入れておりません．ご了解ください．}
その学期はたまたま数学科のほうでも Galois 理論の講義があり，Prolog がはじき出した8つの答えを見た私は，Galois 理論を思い出し，「これにもなにか対称性があるのだろうか」と考えたところ，「あ，$\mathcal{D}_4$だ」となったのでした．

私は運よく (?) 教職も取っていたので，これをなんとか中高生でもわかるような，数学とプログラミングをほどよく混ぜて最後は数学における対称性の重要性に持っていく題材にできないか，と考えました．そこでおおよそ1年をかけてできたのがこの文章です．果たして「中高生でもわかる」ようになっているかは不安ですが，$3\times 3$魔方陣という1つの題材から派生させていろいろ楽しむ様子だけでも感じていただけたら幸いです．

以下，「大人」向けに，この題材の教材化について少し考えたことを書きたいと思います．

実際に教材として使おうと思うなら，
\begin{itemize}
\item[$\rightarrow$] 透明な正方形の板に$3\times 3$のマス目を書き込み，最初は全員でアイデアを出し合って1つの解を得る．

\item[$\rightarrow$] 他の解がないかどうかを，板を回転させるなどに誘導して考える(透明な板を提案したのは1つ解を書き込んだうえで裏返してもその数学が読めるため)，あるいは他の班の解と比較し，何が違うかを見つける．

\item[$\rightarrow$] Prolog を用いて8つ解が出てくるかを確かめる．

\item[$\rightarrow$] Prolog と対称性，どちらにより強く興味があるかで，論理型プログラミング言語から始めてプログラミング言語を見るグループと，Galois 理論等を見るグループに分けて各々説明する．
\end{itemize}
といった構成にできるのではないかと考えています．

おそらく題材のレベルとしても高くなりますし，時間もかかると思われますので，発展中の発展として，長期休暇等に有志で取り組むようなプログラムにするのが適当かと思われます．

東大の数学科には卒業論文というものがありませんが，数学と情報，そして教職を合わせた(ごった煮にした)この文章は，私が学部で学んだことをある程度まとめて提示したものになっており，1つ，卒業論文とまでは行かなくとも，「卒業文集」のようなものにできたのではないかと思います．
\clearpage
\section*{プログラムの結果}
このセクションのみ紙面を削るため，見やすさのために2段組みにしています．また空白行は元の実行では与えられません．最後の ``false'' はこれ以上の結果はないという意味です．
\begin{multicols}{2}
  \begin{lstlisting}
    X11 = 6,
    X12 = 1,
    X13 = 8,
    X21 = 7,
    X22 = 5,
    X23 = 3,
    X31 = 2,
    X32 = 9,
    X33 = 4 ;

    X11 = 8,
    X12 = 1,
    X13 = 6,
    X21 = 3,
    X22 = 5,
    X23 = 7,
    X31 = 4,
    X32 = 9,
    X33 = 2 ;

    X11 = 6,
    X12 = 7,
    X13 = 2,
    X21 = 1,
    X22 = 5,
    X23 = 9,
    X31 = 8,
    X32 = 3,
    X33 = 4 ;

    X11 = 8,
    X12 = 3,
    X13 = 4,
    X21 = 1,
    X22 = 5,
    X23 = 9,
    X31 = 6,
    X32 = 7,
    X33 = 2 ;

    X11 = 2,
    X12 = 7,
    X13 = 6,
    X21 = 9,
    X22 = 5,
    X23 = 1,
    X31 = 4,
    X32 = 3,
    X33 = 8 ;

    X11 = 4,
    X12 = 3,
    X13 = 8,
    X21 = 9,
    X22 = 5,
    X23 = 1,
    X31 = 2,
    X32 = 7,
    X33 = 6 ;

    X11 = 2,
    X12 = 9,
    X13 = 4,
    X21 = 7,
    X22 = 5,
    X23 = 3,
    X31 = 6,
    X32 = 1,
    X33 = 8 ;

    X11 = 4,
    X12 = 9,
    X13 = 2,
    X21 = 3,
    X22 = 5,
    X23 = 7,
    X31 = 8,
    X32 = 1,
    X33 = 6 ;
    false.
  \end{lstlisting}
\end{multicols}
\clearpage

\section*{文献についてと長い余談}
\begin{easylist}[itemize]
  @ 群論について: 文中にも引用した \cite{katura} は一般的に数学科で群論・環論の教科書としても使われる本です．私が初めて群論をまともにやったのはこの本でなので，そこまで初学者に優しくないとは思わない (多くの前提知識を仮定することはない) ですが，優しいとも思いません (初学者へのなんらかの配慮があるかと言うと疑問です)．少なくともなんかしら数学書を読んだ経験は必要だっと思います．特に群準同型$\exp$において$\real$ ($\real_+$) に入れる演算が足し算と掛け算で変わっているところでかなり戸惑った経験は忘れられません (ゼミ形式でやったのですが他の人もしばらく詰まっていました)．しかもそれ ($\exp$) がそのあとリー群論等でめちゃくちゃ重要になるとは...... という個人的な思い出の本です．

  群論については和書洋書含め多数あるので，群論，group theory などで調べて好きなのを読めばいいと思います．ネット上の PDF だけでも結構いけるのではないでしょうか．
  @ Galois 理論について: なぜか日本では Galois 理論は数学にそれほど馴染みのない人でも名前だけは知っている理論の1つで，従ってどちらかと言えば「言葉」で説明した和書がかなり充実していると思います．それらの本は書店で適当に探していただくとして，数学書の方としては，\cite{yukie} を上げておきたいと思います．こちらもガロア理論や環論の教科書としてもスタンダードな和書で，ゼミもやったはずなんですが，難しかったですね...... 

  Galois 理論はグロタンディークによりかなり現代化されているらしく，それについて全く知らなかったのも今回あまり Galois 理論について触れなかった理由ではあるのですが，代数的トポロジーの場面でも ``Galois covering'' というものが出てくるので，なんか，こう，ちょっと，せっかく数学科として出す記事で「解と方程式」だけから議論するのはまずいのかもしれない，と思うなどしています．どなたか Galois 理論一般に強い方の寄稿が待たれます．合作でもよいのかもしれない．

  ちなみに \cite{yukie} の同シリーズの代数学1は群論なのでそっちで群論からコンプリートするのも一手です．

  @ 群とその作用について: 申し訳ないことに，この稿の一大テーマであったこのトピックを包括的かつ専門的に扱っている文献を私は知りません．もちろんリー群等を扱っている文献なら各々少なからず言及はあるのですが，群と群作用のみについて，平易な例から解きほぐしているような数学書は今の所和書洋書問わず見つけられておりません．ご存知の方はぜひご教示ください．

  @ {\Poincare}--Perelman の定理について: 「{\Poincare} 予想」のほうはこれまた日本では Galois 理論と同様の知名度を誇っており，「言葉」で説明した和書には事欠かないと思います．Perelman 本人の証明についても arXiv で無料で閲覧が可能 \cite{perelman} です．

  ただし，実はこの問題は発端が代数的トポロジーであったにもかかわらず解決には Hamilton の開発した Ricci flow という微分幾何的な手法が用いられているので，みんなで微分幾何を，曲率をやろう! \cite{lee} が初学者にオススメだよ! この人の本で困ったら math.stackexchange.com に投げると結構常駐してるっぽいよ! (``Jack Lee'' というアカウントのようです) アフターケアもバッチリだね! という謎かつ雑な勧誘をして終わろうと思います．

  真面目な話をすると，Ricci flow については collected papers \cite{collected} があるのでそれを読むのが速いような気がしています．興味ある方はぜひ読んだ上で私に教えてください．
  
  @ 代数的トポロジーについて: これは私が書くより適任者が居る気がするんですが，一応 \cite{hatcher} を上げておきたいと思います．洋書でかつ結構新しいですがおそらくスタンダードな教科書です．ガンマ $\gamma$のフォントが独特で，何使ってるのか気になります．代トポも広いのでその道のことはその道の方に訊きましょう......

  @ Prolog について: 上で \cite{iitaka} を参考にしたとありますし，事実，飯高先生は数学者ですから，この本は今回の目的に最高の本ということになります---ただ1つの問題である，「古すぎる」ということを除いては．残念なことに，この本の出版年は1990年で，30年近く前です．そのときは最新であったのでしょうが驚きの記述がそこかしこにあります (整数の範囲の驚きの狭さ)．センチメンタルに技術の発展に思いを馳せ，使えるところだけ使うにはいい本ですが，飯高先生の環境と現在の環境とは異なりますし，実際本文と同じクエリを投げても私の環境 (Windows 10 Pro 64bit, SWI-Prolog version 7.6.4) とは挙動が異なることがありました (\cite[p. 18]{iitaka}の \$ によりストリングを作る方法は RUN/PROLOG では動くようですが SWI-Prolog では Operator expected を吐いて終わりました)．

  じゃあ最新の技術書でも持ってくればよかったではないか，と言われるかもしれませんが，なぜか Prolog は和書については 90年を最後にほとんど入門書の類が出版されていません．洋書については \cite{candm} がおそらく最新かと思われますが，東大に所蔵がなかった関係 (と時間の関係) で中身の確認ができておりません．おそらくですが，ネット上の情報のほうが最新で自身の状況にフィットし，有益かと思われます．Google 検索頑張ってください．
\end{easylist}
\begin{thebibliography}{100}
\bibitem[桂]{katura} 代数学I 群と環，桂利行，大学数学の入門1，東京大学出版会，2004
\bibitem[雪江]{yukie} 代数学2 環と体とガロア理論，雪江明彦，日本評論社，2010
\bibitem[Perelman]{perelman} \url{https://arxiv.org/search/math?searchtype=author&query=Perelman}，2002--3 の論文3本が {\Poincare} 予想に関連するもの
\bibitem[Lee]{lee} Riemannian Manifolds---An Introduction to Curvature, John M. Lee, Graduate Texts in Mathematics 176, Springer, 1997
\bibitem[Cao]{collected} Collected papers on Ricci flow, ed. H.D. Cao et al.,
\bibitem[Hatcher]{hatcher}{\scshape Algebraic Topology}, Allen Hatcher, {\scshape Cambridge University Press}, 2001
  % \bibitem[言語モデル論]{gengo} 2017年度 Aセメスター 東京大学理学部情報科学科 言語モデル論 講義資料 (要パスワード，再配布禁止)，小林直樹
  \bibitem[]{} Logic for computer science---foundations of automatic theorem proving, Jean H. Gallier, Originally in 1988

\bibitem[飯高]{iitaka} Prolog で作る数学の世界---Prolog そして集合-位相-群，飯高茂，朝倉書店，1990
  \bibitem[Clocksin \& Mellish]{candm} Programming in Prolog---Using the ISO Standard 5th edition, William F. Clocksin and Christopher S. Mellish, Springer, 2012
  % \bibitem[Ramras]{pdf} \url{http://sofia.nmsu.edu/~ramras/542/universal-cover.pdf}\\ {\scshape Construction of the Universal Covering as a Fiber Bundle}, Daniel.A.Ramras
  % \bibitem[小林]{t.kobayashi} リー群と表現論，小林俊行
\end{thebibliography}
\end{document}